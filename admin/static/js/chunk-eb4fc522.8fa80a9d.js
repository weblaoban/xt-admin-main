(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eb4fc522","chunk-416cad24"],{"080d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-shop-notice"},[a("avue-crud",{ref:"crud",attrs:{page:t.page,data:t.dataList,"table-loading":t.dataListLoading,option:t.tableOption},on:{"search-change":t.searchChange,"on-load":t.getDataList,"refresh-change":t.refreshChange},scopedSlots:t._u([{key:"status",fn:function(e){return[0===e.row.status?a("el-tag",{attrs:{size:"small",type:"danger"}},[t._v("撤销")]):a("el-tag",{attrs:{size:"small"}},[t._v("公布")])]}},{key:"isTop",fn:function(e){return[0===e.row.isTop?a("el-tag",{attrs:{size:"small"}},[t._v("否")]):a("el-tag",{attrs:{size:"small"}},[t._v("是")])]}},{key:"menu",fn:function(e){return[t.isAuth("shop:notice:update")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(a){return t.addOrUpdateHandle(e.row.id)}}},[t._v("修改")]):t._e(),t.isAuth("shop:notice:delete")?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(a){return a.stopPropagation(),t.deleteHandle(e.row.id)}}},[t._v("删除")]):t._e()]}}])},[a("template",{slot:"menuLeft"},[t.isAuth("shop:notice:save")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.addOrUpdateHandle()}}},[t._v("新增")]):t._e()],1)],2),t.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:t.refreshChange}}):t._e()],1)},n=[];const s={searchMenuSpan:6,columnBtn:!1,border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",align:"center",addBtn:!1,editBtn:!1,delBtn:!1,column:[{label:"公告内容",prop:"title",search:!0},{label:"状态",prop:"status",search:!0,slot:!0,type:"select",dicData:[{label:"撤销",value:0},{label:"公布",value:1}]},{label:"是否置顶",prop:"isTop",search:!0,slot:!0,type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]};var o=a("fcc9"),r={data(){return{dataList:[],page:{total:0,currentPage:1,pageSize:10},dataListLoading:!1,tableOption:s,permission:{delBtn:this.isAuth("shop:notice:delete")},addOrUpdateVisible:!1}},components:{AddOrUpdate:o["default"]},created(){},mounted(){},methods:{getDataList(t,e,a){this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/shop/notice/page"),method:"get",params:this.$http.adornParams(Object.assign({current:null==t?this.page.currentPage:t.currentPage,size:null==t?this.page.pageSize:t.pageSize},e))}).then(({data:t})=>{this.dataList=t.records,this.page.total=t.total,this.dataListLoading=!1,a&&a()})},addOrUpdateHandle(t){this.addOrUpdateVisible=!0,this.$nextTick(()=>{this.$refs.addOrUpdate.init(t)})},deleteHandle(t){this.$confirm("确定进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$http({url:this.$http.adornUrl("/shop/notice/"+t),method:"delete",data:this.$http.adornData({})}).then(({data:t})=>{this.$message({message:"操作成功",type:"success",duration:1500,onClose:()=>{this.getDataList()}})})}).catch(()=>{})},refreshChange(){this.getDataList(this.page)},searchChange(t,e){this.getDataList(this.page,t,e)}}},l=r,c=a("2877"),d=Object(c["a"])(l,i,n,!1,null,"377de5a6",null);e["default"]=d.exports},"0e93":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tinymce-container",class:{fullscreen:t.fullscreen},style:{width:t.containerWidth}},[a("textarea",{staticClass:"tinymce-textarea",attrs:{id:t.tinymceId}}),t._v(" "),a("div",{staticClass:"editor-custom-btn-container"},[a("el-upload",{staticClass:"upload-demo",attrs:{"list-type":"picture",action:t.$http.adornUrl("/admin/file/upload/element"),headers:{Authorization:t.$cookie.get("Authorization")},"on-success":t.imageSuccessCBK,"show-file-list":!1,"before-upload":t.beforeAvatarUpload}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传图片")])],1)],1)])},n=[],s=a("bcf3");const o=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"];var r=o;const l=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"];var c=l;let d=[];function u(){return window.tinymce}const h=(t,e)=>{const a=document.getElementById(t),i=e||function(){};if(!a){const e=document.createElement("script");e.src=t,e.id=t,document.body.appendChild(e),d.push(i);const a="onload"in e?n:s;a(e)}function n(e){e.onload=function(){this.onerror=this.onload=null;for(const t of d)t(null,e);d=null},e.onerror=function(){document.body.removeChild(e),this.onerror=this.onload=null,i(new Error("Failed to load "+t),e)}}function s(t){t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;for(const e of d)e(null,t);d=null}}}a&&i&&(u()?i(null,a):d.push(i))};var p=h;const m="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",g="https://unpkg.zhimg.com/tinymce-all-in-one@4.9.3/tinymce.min.js",f="https://unpkg.com/tinymce-all-in-one@4.9.3/tinymce.min.js";var b={name:"Tinymce",components:{mulPicUpload:s["a"]},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,resourcesUrl:"http://8.140.252.39/"}},computed:{language(){return localStorage.getItem("lang")||"zh_CN"},containerWidth(){const t=this.width;return/^[\d]+(\.[\d]+)?$/.test(t)?t+"px":t}},watch:{value(t){!this.hasChange&&this.hasInit&&this.$nextTick(()=>window.tinymce.get(this.tinymceId).setContent(t||""))},language(){this.destroyTinymce(),this.$nextTick(()=>this.initTinymce())}},mounted(){this.init()},activated(){window.tinymce&&this.initTinymce()},deactivated(){this.destroyTinymce()},destroyed(){this.destroyTinymce()},methods:{init(){p(m,t=>{t?p(g,e=>{e?p(f,e=>{e?this.$message.error(t.message):this.initTinymce()}):this.initTinymce()}):this.initTinymce()})},initTinymce(){const t=this;window.tinymce.init({language:this.language,selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:c,menubar:this.menubar,plugins:r,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:e=>{t.value&&e.setContent(t.value),t.hasInit=!0,e.on("NodeChange Change KeyUp SetContent",()=>{this.hasChange=!0,this.$emit("input",e.getContent())})},setup(e){e.on("FullscreenStateChanged",e=>{t.fullscreen=e.state})},convert_urls:!1})},destroyTinymce(){const t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent(t){window.tinymce&&window.tinymce.get(this.tinymceId).setContent(t)},getContent(){window.tinymce.get(this.tinymceId).getContent()},beforeAvatarUpload(t){const e="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type||"image/jpg"===t.type;e||this.$message.error("上传图片只能是jpeg/jpg/png/gif 格式!");const a=t.size/1024/1024<2;return a||this.$message.error("上传图片大小不能超过 2MB!"),a&&e},imageSuccessCBK(t,e,a){const i=this;a.forEach(t=>{window.tinymce.get(i.tinymceId).insertContent(`<img class="wscnph" src="${this.resourcesUrl+"/images/"+t.response.data}" >`)})}}},y=b,v=(a("1a85"),a("2877")),_=Object(v["a"])(y,i,n,!1,null,"7ef81f2a",null);e["a"]=_.exports},"1a85":function(t,e,a){"use strict";a("948b")},"20ca":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));const i=(t,e)=>{let a,i=e||300;return function(){let e=arguments;a&&clearTimeout(a);let n=!a;a=setTimeout(()=>{a=null},i),n&&t.apply(this,e)}}},"948b":function(t,e,a){},bcf3:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{attrs:{action:t.$http.adornUrl("/admin/file/upload/element"),headers:{Authorization:t.$cookie.get("Authorization")},"list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.handleUploadSuccess,"file-list":t.imageList,"before-upload":t.beforeAvatarUpload}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},n=[],s={data(){return{dialogImageUrl:"",dialogVisible:!1,resourcesUrl:"http://8.140.252.39/"}},props:{value:{default:"",type:String}},computed:{imageList(){let t=[];if(this.value){let e=this.value.split(",");for(let a=0;a<e.length;a++)t.push({url:this.resourcesUrl+e[a],response:e[a]})}return this.$emit("input",this.value),t}},methods:{handleUploadSuccess(t,e,a){let i=a.map(t=>t.response).join(",");this.$emit("input",i)},beforeAvatarUpload(t){const e="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type||"image/jpg"===t.type;e||this.$message.error("上传图片只能是jpeg/jpg/png/gif 格式!");const a=t.size/1024/1024<2;return a||this.$message.error("上传图片大小不能超过 2MB!"),a&&e},handleRemove(t,e){let a=e.map(t=>t.response).join(",");this.$emit("input",a)},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0}}},o=s,r=a("2877"),l=Object(r["a"])(o,i,n,!1,null,null,null);e["a"]=l.exports},fcc9:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"80px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"公告标题",prop:"title"}},[a("el-input",{model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:t.dataForm.status,callback:function(e){t.$set(t.dataForm,"status",e)},expression:"dataForm.status"}},[a("el-radio",{attrs:{label:1}},[t._v("公布")]),a("el-radio",{attrs:{label:0}},[t._v("撤销")])],1)],1),a("el-form-item",{attrs:{label:"置顶",prop:"isTop"}},[a("el-radio-group",{model:{value:t.dataForm.isTop,callback:function(e){t.$set(t.dataForm,"isTop",e)},expression:"dataForm.isTop"}},[a("el-radio",{attrs:{label:1}},[t._v("是")]),a("el-radio",{attrs:{label:0}},[t._v("否")])],1)],1),a("el-form-item",{attrs:{label:"公告内容",prop:"content"}},[a("tiny-mce",{model:{value:t.dataForm.content,callback:function(e){t.$set(t.dataForm,"content",e)},expression:"dataForm.content"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},n=[],s=a("0e93"),o=a("20ca"),r={data(){var t=(t,e,a)=>{e.trim()?a():(this.dataForm.title="",a(new Error("公告标题不能为空")))};return{visible:!1,roleList:[],dataForm:{title:null,content:null,url:null,status:1,isTop:0},dataRule:{title:[{required:!0,message:"公告标题不能为空",trigger:"blur"},{validator:t,trigger:"blur"}]}}},components:{TinyMce:s["a"]},methods:{init(t){this.dataForm.id=t||0,this.visible=!0,this.$nextTick(()=>{this.$refs["dataForm"].resetFields(),this.dataForm.id&&this.$http({url:this.$http.adornUrl("/shop/notice/info/"+this.dataForm.id),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.dataForm=t})})},dataFormSubmit:Object(o["a"])((function(){this.$refs["dataForm"].validate(t=>{t&&this.$http({url:this.$http.adornUrl("/shop/notice"),method:this.dataForm.id?"put":"post",data:this.$http.adornData(this.dataForm)}).then(({data:t})=>{this.$message({message:"操作成功",type:"success",duration:1500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList"),this.dataForm.content=""}})})})}))}},l=r,c=a("2877"),d=Object(c["a"])(l,i,n,!1,null,null,null);e["default"]=d.exports}}]);