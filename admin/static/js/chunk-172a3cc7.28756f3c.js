(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-172a3cc7"],{"13fe":function(t,e,a){"use strict";a("db0a")},"20ca":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));const i=(t,e)=>{let a,i=e||300;return function(){let e=arguments;a&&clearTimeout(a);let s=!a;a=setTimeout(()=>{a=null},i),s&&t.apply(this,e)}}},"574f":function(t,e,a){"use strict";a("d015")},cf95:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{staticClass:"pic-uploader-component",attrs:{action:t.$http.adornUrl("/admin/file/upload/element"),headers:{Authorization:t.$cookie.get("Authorization")},"show-file-list":!1,"on-success":t.handleUploadSuccess,"before-upload":t.beforeAvatarUpload}},[t.value?a("img",{staticClass:"pic",attrs:{src:t.value}}):a("i",{staticClass:"el-icon-plus pic-uploader-icon"})])],1)},s=[],r={data(){return{resourcesUrl:"http://8.140.252.39/"}},props:{value:{default:"",type:String}},methods:{handleUploadSuccess(t,e,a){console.log(e),this.$emit("input",this.resourcesUrl+"images/"+e.response.data)},beforeAvatarUpload(t){const e=t.size/1024/1024<2,a="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type||"image/jpg"===t.type;return a||this.$message.error("上传图片只能是jpeg/jpg/png/gif 格式!"),e||this.$message.error("上传图片大小不能超过 2MB!"),e&&a}}},l=r,o=(a("13fe"),a("2877")),n=Object(o["a"])(l,i,s,!1,null,null,null);e["a"]=n.exports},d015:function(t,e,a){},db0a:function(t,e,a){},f96a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-index-img"},[a("el-dialog",{attrs:{title:"编辑","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-position":"top","label-width":"100px"}},[a("el-form-item",{attrs:{label:"1.上传图片",prop:"imgUrl"}},[a("pic-upload",{model:{value:t.dataForm.imgUrl,callback:function(e){t.$set(t.dataForm,"imgUrl",e)},expression:"dataForm.imgUrl"}})],1),a("el-form-item",{attrs:{label:"2.图片链接"}},[a("el-radio-group",{on:{change:t.deleteRelation},model:{value:t.dataForm.type,callback:function(e){t.$set(t.dataForm,"type",e)},expression:"dataForm.type"}},[a("el-radio",{attrs:{label:-1}},[t._v("不跳转链接")]),a("el-radio",{attrs:{label:0}},[t._v("跳转")])],1)],1),0==t.dataForm.type?a("div",[a("el-form-item",{attrs:{label:"",prop:"link"}},[a("el-input",{attrs:{placeholder:" 复制链接到对话框中"},model:{value:t.dataForm.link,callback:function(e){t.$set(t.dataForm,"link",e)},expression:"dataForm.link"}})],1)],1):t._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmit()}}},[t._v("确定")])],1)],1)],1),t.prodsSelectVisible?a("prods-select",{ref:"prodsSelect",attrs:{isSingle:!0},on:{refreshSelectProds:t.selectCouponProds}}):t._e()],1)},s=[],r=a("cf95"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"选择商品",modal:!1,"close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],ref:"prodTable",staticStyle:{width:"100%"},attrs:{data:t.dataList,border:""},on:{"selection-change":t.selectChangeHandle}},[t.isSingle?a("el-table-column",{attrs:{width:"50","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-radio",{attrs:{label:e.row.prodId},nativeOn:{change:function(a){return t.getSelectProdRow(e.row)}},model:{value:t.singleSelectProdId,callback:function(e){t.singleSelectProdId=e},expression:"singleSelectProdId"}},[t._v(" ")])],1)]}}],null,!1,870715150)}):t._e(),t.isSingle?t._e():a("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"prodName","header-align":"center",align:"center",label:"产品名称"}}),a("el-table-column",{attrs:{align:"center",width:"140",label:"产品图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.pic,width:"100",height:"100"}})]}}])})],1),a("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}}),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitProds()}}},[t._v("确定")])],1)],1)},o=[],n={data(){return{visible:!1,dataForm:{product:""},singleSelectProdId:0,allData:[],selectProds:[],dataList:[],pageIndex:1,pageSize:10,totalPage:0,dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1}},props:{isSingle:{default:!1,type:Boolean}},activated(){this.getDataList()},methods:{init(t){this.selectProds=t,this.visible=!0,this.dataListLoading=!0,this.selectProds&&this.selectProds.forEach(t=>{this.dataListSelections.push(t)}),this.getDataList()},getDataList(){this.$http({url:this.$http.adornUrl("/prod/prod/page"),method:"get",params:this.$http.adornParams(Object.assign({current:this.pageIndex,size:this.pageSize},{prodName:this.dataForm.prodName}))}).then(({data:t})=>{this.dataList=t.records,this.totalPage=t.total,this.dataListLoading=!1,this.selectProds&&this.$nextTick(()=>{this.selectProds.forEach(t=>{let e=this.dataList.findIndex(e=>e.prodId===t.prodId);this.$refs.prodTable.toggleRowSelection(this.dataList[e])})})})},sizeChangeHandle(t){this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle(t){this.pageIndex=t,this.getDataList()},getSelectProdRow(t){this.dataListSelections=[t]},selectChangeHandle(t){this.dataList.forEach(e=>{let a=t.findIndex(t=>!!t&&t.prodId===e.prodId),i=this.dataListSelections.findIndex(t=>t.prodId===e.prodId);a>-1&&-1===i?this.dataListSelections.push(e):-1===a&&i>-1&&this.dataListSelections.splice(i,1)})},submitProds(){if(!this.dataListSelections.length)return void this.$message({message:"请选择商品",type:"error",duration:1e3,onClose:()=>{}});let t=[];this.dataListSelections.forEach(e=>{let a=t.findIndex(t=>t.prodId===e.prodId);-1===a&&t.push({prodId:e.prodId,prodName:e.prodName,pic:e.pic})}),this.$emit("refreshSelectProds",t),this.dataListSelections=[],this.visible=!1}}},d=n,c=a("2877"),p=Object(c["a"])(d,l,o,!1,null,null,null),u=p.exports,h=a("20ca"),m={data(){return{dataForm:{status:1,des:"",imgUrl:"",seq:0,imgId:0,type:-1,relation:null,link:""},dataRule:{imgUrl:[{required:!0,message:"轮播图片不能为空",trigger:"blur"}],link:[{required:!0,message:"跳转链接不能为空",trigger:"blur"}]},card:{id:0,pic:"",name:"",realData:{prod:[],shop:[],activity:[]}},page:{total:0,currentPage:1,pageSize:10},prodsSelectVisible:!1,visible:!1}},components:{PicUpload:r["a"],ProdsSelect:u},methods:{init(t){this.visible=!0,this.dataForm.imgId=t||0,this.dataForm.imgId?this.$http({url:this.$http.adornUrl("/admin/content/info/"+this.dataForm.imgId),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.dataForm=t,t.link?this.dataForm.type=0:this.dataForm.type=-1}):this.$nextTick(()=>{this.$refs["dataForm"].resetFields(),this.dataForm.imgUrl=""})},dataFormSubmit:Object(h["a"])((function(){this.$refs["dataForm"].validate(t=>{if(!t)return;let e=this.dataForm;this.$http({url:this.$http.adornUrl("/admin/content"),method:e.id?"put":"post",data:this.$http.adornData(e)}).then(({data:t})=>{this.$message({message:"操作成功",type:"success",duration:1500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList",this.page)}})})})})),deleteRelation(t){this.dataForm.type=t}}},g=m,f=(a("574f"),Object(c["a"])(g,i,s,!1,null,null,null));e["default"]=f.exports}}]);